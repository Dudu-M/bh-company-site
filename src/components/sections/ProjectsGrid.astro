---
import { getCollection } from 'astro:content';
import { Calendar, MapPin} from 'lucide-astro';

interface Props {
  limit?: number;
  class?: string;
}

const { limit, class: className = '' } = Astro.props;

// Get all projects
const allProjects = await getCollection('projects');
const projects = limit ? allProjects.slice(0, limit) : allProjects;
---

<section class={`section-spacing bg-neutral-50 ${className}`}>
  <div class="container-custom">
    
    <!-- Section Header -->
    <div class="mb-12 slide-up">
      <h2 class="text-primary-500">All Projects</h2>
    </div>

    <!-- Projects List -->
    <div class="space-y-8">
      {projects.map((project, index) => (
        <a 
          href={`/operations/${project.slug}`}
          class="group block slide-up"
          style={`animation-delay: ${index * 0.1}s`}
        >
          <article class="bg-white rounded-2xl overflow-hidden transition-all duration-300 hover:shadow-xl hover:-translate-y-1">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-0">
              
              <!-- Image - 2 columns -->
              <div class="lg:col-span-2 relative h-80 lg:h-auto overflow-hidden">
                <img 
                  src={project.data.image} 
                  alt={project.data.title}
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                />
                {project.data.status && (
                  <div class="absolute top-4 left-4">
                    <span class={`inline-block px-4 py-2 rounded-full text-sm font-semibold ${
                      project.data.status === 'ongoing' ? 'bg-green-500 text-white' :
                      project.data.status === 'completed' ? 'bg-blue-500 text-white' :
                      'bg-yellow-500 text-white'
                    }`}>
                      {project.data.status.charAt(0).toUpperCase() + project.data.status.slice(1)}
                    </span>
                  </div>
                )}
              </div>

              <!-- Content - 3 columns -->
              <div class="lg:col-span-3 p-8 lg:p-12 flex flex-col justify-center">
                <h3 class="text-primary-500 text-2xl md:text-3xl font-bold mb-3 group-hover:text-accent-500 transition-colors">
                  {project.data.title}
                </h3>
                
                {project.data.subtitle && (
                  <p class="text-accent-500 text-lg font-semibold mb-4">
                    {project.data.subtitle}
                  </p>
                )}

                <p class="text-neutral-600 text-lg leading-relaxed mb-6 line-clamp-4">
                  {project.data.description}
                </p>

                {(project.data.location || project.data.year) && (
                  <div class="flex flex-wrap gap-4 text-sm text-neutral-500">
                    {project.data.location && (
                      <span>üìç {project.data.location}</span>
                    )}
                    {project.data.year && (
                      <span>üìÖ {project.data.year}</span>
                    )}
                  </div>
                )}
              </div>

            </div>
          </article>
        </a>
      ))}
    </div>

  </div>
</section>