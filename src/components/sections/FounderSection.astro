---
import { Mail, Phone, Linkedin, Download, FileText } from 'lucide-astro';
import Button from '../ui/Button.astro';

interface TeamMember {
  name: string;
  title: string;
  email?: string;
  phone?: string;
  whatsapp?: string;
  linkedin?: string;
  image: string;
  awardBadge?: string;
  bio: string[];
  cvLink?: string;
}

interface Props {
  heading?: string;
  members: TeamMember[];
  background?: 'white' | 'grey';
  class?: string;
}

const { 
  heading = 'Meet the Founder',
  members,
  background = 'white',
  class: className = ''
} = Astro.props;

const bgClass = background === 'white' ? 'bg-white' : 'bg-neutral-50';
---

<section class={`section-spacing ${bgClass} ${className}`}>
  <div class="container-custom">
    
    <!-- Section Header -->
    <div class="text-center mb-16 slide-up">
      <h2 class="text-primary-500">{heading}</h2>
    </div>

    <!-- Team Cards -->
    <div class="max-w-6xl mx-auto">
      {members.map((member) => (
        <div class="mb-10 last:mb-0 bg-white shadow-lg border border-neutral-200 p-6 md:p-8 lg:p-10">
          <div class="grid grid-cols-1 lg:grid-cols-5 gap-12 items-start">
            
            <!-- Left: Image (2 columns) -->
            <div class="lg:col-span-2 slide-up">
              <div class="relative aspect-[3/4] overflow-hidden rounded-2xl shadow-xl">
                <img
                  src={member.image}
                  alt={member.name}
                  class="w-full h-full object-cover"
                />
                
                <!-- Award Badge Overlay -->
                {member.awardBadge && (
                  <div class="absolute bottom-6 left-6 w-32 aspect-[3/4] rounded-xl overflow-hidden shadow-2xl ring-4 ring-white">
                    <img
                      src={member.awardBadge}
                      alt="Award"
                      class="w-full h-full object-cover"
                    />
                  </div>
                )}
              </div>
            </div>

            <!-- Right: Info (3 columns) -->
            <div class="lg:col-span-3 slide-up slide-up-delay-1">
              
              <!-- Name, Title, LinkedIn | Contact Info -->
              <div class="flex flex-col md:flex-row md:justify-between md:items-end gap-6 mb-8 pb-6 border-b border-neutral-200">
                
                <!-- Left: Name & Title -->
                <div>
                  <h4 class="text-primary-500 text-3xl md:text-4xl font-bold">
                    {member.name}
                  </h4>
                  <p class="text-accent-500 text-xl font-semibold mt-1">
                    {member.title}
                  </p>
                </div>

                <!-- Right: Contact Icons -->
                <div class="flex items-center justify-end gap-3 self-end">
                  {member.email && (
                    <a
                      href={member.email ? `mailto:${member.email}` : '#'}
                      title={member.email ?? 'No email provided'}
                      aria-label={member.email ? `Email ${member.name}` : 'No email provided'}
                      class={`w-10 h-10 rounded-full border flex items-center justify-center transition-colors ${member.email ? 'text-primary-500 border-primary-500 hover:text-white hover:bg-primary-500' : 'text-primary-500/40 border-primary-500/40 pointer-events-none'}`}
                    >
                      <Mail class="w-4 h-4" />
                    </a>
                  )}

                  {member.email && (
                    <a
                      href={member.phone ? (member.whatsapp ? `https://wa.me/${member.whatsapp.replace(/\D/g, '')}` : `tel:${member.phone}`) : '#'}
                      target={member.phone && member.whatsapp ? '_blank' : undefined}
                      rel={member.phone && member.whatsapp ? 'noopener noreferrer' : undefined}
                      title={member.phone ?? 'No phone number provided'}
                      aria-label={member.phone ? `Call ${member.name}` : 'No phone number provided'}
                      class={`w-10 h-10 rounded-full border flex items-center justify-center transition-colors ${member.phone ? 'text-primary-500 border-primary-500 hover:text-white hover:bg-primary-500' : 'text-primary-500/40 border-primary-500/40 pointer-events-none'}`}
                    >
                      <Phone class="w-4 h-4" />
                    </a>
                  )}

                  {member.email && (  
                    <a
                      href={member.linkedin ?? '#'}
                      target={member.linkedin ? '_blank' : undefined}
                      rel={member.linkedin ? 'noopener noreferrer' : undefined}
                      title={member.linkedin ?? 'No LinkedIn profile provided'}
                      aria-label={member.linkedin ? `LinkedIn profile for ${member.name}` : 'No LinkedIn profile provided'}
                      class={`w-10 h-10 rounded-full border flex items-center justify-center transition-colors ${member.linkedin ? 'text-primary-500 border-primary-500 hover:text-white hover:bg-primary-500' : 'text-primary-500/40 border-primary-500/40 pointer-events-none'}`}
                    >
                      <Linkedin class="w-4 h-4" />
                    </a>
                  )}
                </div>
              </div>
              
              <!-- Bio -->
              <div class="space-y-4 mb-8">
                {member.bio.map((paragraph) => (
                  <p class="text-neutral-600 text-lg leading-relaxed">
                    {paragraph}
                  </p>
                ))}
              </div>

              <!-- CV Download -->
              {member.cvLink && (
                <div class="flex flex-col sm:flex-row gap-4">
                  <Button
                    href={member.cvLink}
                    variant="outline"
                    size="md"
                    class="!rounded-full"
                  >
                    <FileText class="w-5 h-5" />
                    View CV
                  </Button>
                  <Button 
                    href={member.cvLink}
                    variant="outline"
                    size="md"
                    class="!rounded-full !text-accent-500 !border-0 !px-0 hover:bg-transparent !hover:text-primary-500 focus:ring-0 focus:ring-offset-0"
                  >
                    <Download class="w-5 h-5 mr-0" />
                  </Button>
                </div>
              )}
            </div>
          </div>
        </div>
      ))}

    </div>

  </div>
</section>
